dnl ===========================
dnl checks for Festival Plug In
dnl ===========================

AC_ARG_ENABLE(kttsd-festival,
              AC_HELP_STRING([--enable-kttsd-festival],
                             [build KTTSD Festival plugin [default=no]]),
              festival_plugin=$enableval,
              festival_plugin=no)

AC_ARG_WITH(festival-includes,
            AC_HELP_STRING([--with-festival-includes=DIR],
                           [use Festival includes installed in this directory]),
            ac_festival_incdir=$withval,
            ac_festival_incdir=/opt/festival/src/include/)

AC_ARG_WITH(festival-libraries,
            AC_HELP_STRING([--with-festival-libraries=DIR],
                           [use Festival libraries installed in this directory]),
            ac_festival_libdir=$withval,
            ac_festival_libdir=/opt/festival/src/lib/)

AC_ARG_WITH(speech_tools-includes,
            AC_HELP_STRING([--with-speech_tools-includes=DIR],
                           [use Speech Tools includes installed in this directory]),
            ac_speech_tools_incdir=$withval,
            ac_speech_tools_incdir=/opt/speech_tools/include/)

AC_ARG_WITH(speech_tools-libraries,
            AC_HELP_STRING([--with-speech_tools-libraries=DIR],
                           [use Speech Tools libraries installed in this directory]),
            ac_speech_tools_libdir=$withval,
            ac_speech_tools_libdir=/opt/speech_tools/lib/)

compile_festival_plugin="no"

if test "x$festival_plugin" = "xyes"; then
  compile_festival_plugin="yes"
fi


AC_MSG_CHECKING([for Speech Tools])

dnl Check for speech stools
dnl check header files
speech_tools_incdirs="$ac_speech_tools_incdir /usr/include /usr/local/include /usr/include/speech_tools /usr/local/include/speech_tools"
AC_FIND_FILE("EST.h", $speech_tools_incdirs, speech_tools_incdir)
if test $speech_tools_incdir = NO
then
  compile_festival_plugin="no"
else
   SPEECH_TOOLS_INCDIR=$speech_tools_incdir
   AC_SUBST(SPEECH_TOOLS_INCDIR)
fi

dnl check libraries
speech_tools_libdirs="$ac_speech_tools_libdir /usr/lib /usr/local/lib /usr/lib/speech_tools /usr/local/lib/speech_tools"
AC_FIND_FILE("libestools.a", $speech_tools_libdirs, speech_tools_libdir)
if test speech_tools_libdir = NO
then
  compile_festival_plugin="no"
else
  SPEECH_TOOLS_LIBDIR=$speech_tools_libdir
  AC_SUBST(SPEECH_TOOLS_LIBDIR)
fi

if test "$compile_festival_plugin" = "yes"; then
  AC_MSG_RESULT([libraries $speech_tools_libdir, headers $speech_tools_incdir])
else
  AC_MSG_RESULT(not found)
fi


AC_MSG_CHECKING([for Festival])

dnl Check for festival
dnl check header files
festival_incdirs="$ac_festival_incdir /usr/include /usr/local/include /usr/include/festival /usr/local/include/festival"
AC_FIND_FILE("festival.h", $festival_incdirs, festival_incdir)
if test $festival_incdir = NO
then
  compile_festival_plugin="no"
else
   FESTIVAL_INCDIR=$festival_incdir
   AC_SUBST(FESTIVAL_INCDIR)
fi

dnl check libraries
festival_libdirs="$ac_festival_libdir /usr/lib /usr/local/lib /usr/lib/festival /usr/local/lib/festival"
AC_FIND_FILE("libFestival.a", $festival_libdirs, festival_libdir)
if test $festival_libdir = NO
then
  compile_festival_plugin="no"
else
  FESTIVAL_LIBDIR=$festival_libdir
  AC_SUBST(FESTIVAL_LIBDIR)
fi

if test "$compile_festival_plugin" = "yes"; then
  AC_MSG_RESULT([libraries $festival_libdir, headers $festival_incdir])
else
  AC_MSG_RESULT(not found)
fi

dnl Festival include files refuses to build with -pedantic, let's workarround it :(
CXXFLAGS_FESTIVAL=`echo "$CXXFLAGS" | sed -e 's/-pedantic//'`

AM_CONDITIONAL(include_kttsd_festival, test "x$compile_festival_plugin" = "xyes")
